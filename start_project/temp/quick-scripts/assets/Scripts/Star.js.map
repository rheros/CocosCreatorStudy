{"version":3,"sources":["Star.js"],"names":["cc","Class","extends","Component","properties","pickRadius","timer","starDuration","getPlayerDistance","playerPos","game","player","getPosition","dist","pDistance","node","position","onPicked","spawnNewStar","gainScore","destroy","onLoad","update","dt","console","log","gameOver","opacityRatio","minOpacity","opacity","Math","floor"],"mappings":";;;;;;AACAA,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACRC,oBAAY,CADJ;AAERC,eAAM,CAFE;AAGRC,sBAAa;AAHL,KAHP;AAQLC,qBARK,+BAQe;AAChB;AACA,YAAIC,YAAY,KAAKC,IAAL,CAAUC,MAAV,CAAiBC,WAAjB,EAAhB;AACA;AACA,YAAIC,OAAOb,GAAGc,SAAH,CAAa,KAAKC,IAAL,CAAUC,QAAvB,EAAiCP,SAAjC,CAAX;AACA,eAAOI,IAAP;AACH,KAdI;AAeLI,YAfK,sBAeM;AACP;AACA,aAAKP,IAAL,CAAUQ,YAAV;AACA,aAAKR,IAAL,CAAUS,SAAV;AACA;AACA,aAAKJ,IAAL,CAAUK,OAAV;AACH,KArBI;;AAsBL;;AAECC,UAxBI,oBAwBM;AACR,aAAKd,YAAL,GAAmB,KAAKG,IAAL,CAAUH,YAA7B;AACD,KA1BG;;;AA4BL;;AAEA;;AAEAe,UAhCK,kBAgCEC,EAhCF,EAgCM;AACP,YAAI,KAAKjB,KAAL,GAAa,KAAKC,YAAtB,EAAoC;AAChCiB,oBAAQC,GAAR,CAAY,gBAAZ;AACA,iBAAKf,IAAL,CAAUgB,QAAV;AACA;AACH;AACD,aAAKpB,KAAL,IAAciB,EAAd;AACA,YAAI,KAAKf,iBAAL,KAA2B,KAAKH,UAApC,EAAgD;AAC5C;AACA,iBAAKY,QAAL;AACA;AACH;AACD,YAAIU,eAAe,IAAI,KAAKjB,IAAL,CAAUJ,KAAV,GAAgB,KAAKI,IAAL,CAAUH,YAAjD;AACA,YAAIqB,aAAa,EAAjB;AACA,aAAKb,IAAL,CAAUc,OAAV,GAAoBD,aAAaE,KAAKC,KAAL,CAAWJ,gBAAgB,MAAMC,UAAtB,CAAX,CAAjC;AACH;AA/CI,CAAT","file":"Star.js","sourceRoot":"..\\..\\..\\..\\assets\\Scripts","sourcesContent":["\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        pickRadius: 0,\r\n        timer:0,\r\n        starDuration:0\r\n    },\r\n    getPlayerDistance() {\r\n        // 根据 player 节点位置判断距离\r\n        var playerPos = this.game.player.getPosition();\r\n        // 根据两点位置计算两点之间距离\r\n        var dist = cc.pDistance(this.node.position, playerPos);\r\n        return dist;\r\n    },\r\n    onPicked() {\r\n        // 当星星被收集时，调用 Game 脚本中的接口，生成一个新的星星\r\n        this.game.spawnNewStar();\r\n        this.game.gainScore();\r\n        // 然后销毁当前星星节点\r\n        this.node.destroy();\r\n    },\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n     onLoad () {\r\n       this.starDuration= this.game.starDuration\r\n     },\r\n\r\n    // start() {\r\n\r\n    // },\r\n\r\n    update(dt) {\r\n        if (this.timer > this.starDuration) {\r\n            console.log(\"game from star\")\r\n            this.game.gameOver();\r\n            return\r\n        }\r\n        this.timer += dt;\r\n        if (this.getPlayerDistance() < this.pickRadius) {\r\n            // 调用收集行为\r\n            this.onPicked();\r\n            return;\r\n        }\r\n        var opacityRatio = 1 - this.game.timer/this.game.starDuration;\r\n        var minOpacity = 50;\r\n        this.node.opacity = minOpacity + Math.floor(opacityRatio * (255 - minOpacity));\r\n    },\r\n});\r\n"]}